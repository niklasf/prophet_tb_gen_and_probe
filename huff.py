from dahuffman import HuffmanCodec

freqs = {
    0:   37540028,
    1:     123402,
    2:     642797,
    3:     446348,
    4:    1529390,
    5:    1156478,
    6:    2019601,
    7:    1941102,
    8:    2510911,
    9:    2651451,
    10:    2815930,
    11:    3190128,
    12:    3182096,
    13:    3528771,
    14:    3491811,
    15:    3709188,
    16:    3834646,
    17:    3822878,
    18:    3881496,
    19:    3948132,
    20:    3486898,
    21:    3693898,
    22:    2858970,
    23:    2849299,
    24:    2485754,
    25:    2164324,
    26:    2119120,
    27:    1845421,
    28:    1829245,
    29:    1660406,
    30:    1649409,
    31:    1467358,
    32:    1325325,
    33:    1355035,
    34:     894962,
    35:    1026075,
    36:     509676,
    37:     614812,
    38:     331923,
    39:     378262,
    40:     260903,
    41:     261765,
    42:     216107,
    43:     199175,
    44:     185188,
    45:     158897,
    46:     163855,
    47:     133607,
    48:     146549,
    49:     132427,
    50:     159766,
    51:     151617,
    52:     186773,
    53:     196930,
    54:     230665,
    55:     245027,
    56:     265172,
    57:     308683,
    58:     253730,
    59:     333306,
    60:     175356,
    61:     255662,
    62:      86600,
    63:     119261,
    64:      43094,
    65:      39779,
    66:      22338,
    67:      13771,
    68:      10058,
    69:       3892,
    70:       3553,
    71:        591,
    72:        779,
    73:        257,
    74:        390,
    75:        126,
    76:        160,
    77:         42,
    78:         65,
    79:         25,
    80:         28,
    81:          9,
    82:         10,
    83:          3,
    84:          4,
    85:          1,
    86:          1,
}

freqs = {
  0: 5945704684,
  1:   71181290,
  2:  287054466,
  3:  228733577,
  4:  592598271,
  5:  549685034,
  6:  683434692,
  7:  773547598,
  8:  712494066,
  9:  822732963,
 10:  715250742,
 11:  806876279,
 12:  717126327,
 13:  760003413,
 14:  710233382,
 15:  707316127,
 16:  695637818,
 17:  664180243,
 18:  675002327,
 19:  630437651,
 20:  653543375,
 21:  577217621,
 22:  595044008,
 23:  510509908,
 24:  487346709,
 25:  439634532,
 26:  376155792,
 27:  354209175,
 28:  302879958,
 29:  286375948,
 30:  258501418,
 31:  246484436,
 32:  226846831,
 33:  214260960,
 34:  199383004,
 35:  182784503,
 36:  163860861,
 37:  151739320,
 38:  124011909,
 39:  126364057,
 40:   93590939,
 41:  102750735,
 42:   73194570,
 43:   80549870,
 44:   59569904,
 45:   63157913,
 46:   50169416,
 47:   51027244,
 48:   43212624,
 49:   41507163,
 50:   40968616,
 51:   37270787,
 52:   42789831,
 53:   38537277,
 54:   48575969,
 55:   43154207,
 56:   55255849,
 57:   49445093,
 58:   62400435,
 59:   54570824,
 60:   64055921,
 61:   54925910,
 62:   55434471,
 63:   49588326,
 64:   41059329,
 65:   41314868,
 66:   28845287,
 67:   31564102,
 68:   20298108,
 69:   22514129,
 70:   14463706,
 71:   15501413,
 72:   10639416,
 73:   10937347,
 74:    8225301,
 75:    8283890,
 76:    6642176,
 77:    6786844,
 78:    5614557,
 79:    5780139,
 80:    4982292,
 81:    4923762,
 82:    4455533,
 83:    4217584,
 84:    3931645,
 85:    3587817,
 86:    3414012,
 87:    3026815,
 88:    2888372,
 89:    2475593,
 90:    2450165,
 91:    2036735,
 92:    2167024,
 93:    1852823,
 94:    2081107,
 95:    1794362,
 96:    2049949,
 97:    1691522,
 98:    1898950,
 99:    1535569,
100:    1656650,
101:    1359293,
102:    1456853,
103:    1194844,
104:    1281388,
105:    1069851,
106:    1124444,
107:     960085,
108:    1030634,
109:     902358,
110:    1002217,
111:     896849,
112:    1028724,
113:     923671,
114:    1086789,
115:     963136,
116:    1132265,
117:    1007781,
118:    1175931,
119:    1024049,
120:    1185453,
121:    1051677,
122:    1237895,
123:    1121217,
124:    1305003,
125:    1215531,
126:    1379738,
127:    1315411,
128:    1429908,
129:    1454251,
130:    1456699,
131:    1611540,
132:    1443479,
133:    1697133,
134:    1396604,
135:    1689895,
136:    1259534,
137:    1561628,
138:    1078429,
139:    1369014,
140:     900843,
141:    1194920,
142:     776146,
143:    1056761,
144:     705202,
145:     915274,
146:     656050,
147:     739073,
148:     603582,
149:     588138,
150:     566113,
151:     488884,
152:     522220,
153:     413936,
154:     485784,
155:     373026,
156:     498829,
157:     406600,
158:     539791,
159:     445063,
160:     563852,
161:     454197,
162:     577709,
163:     447993,
164:     611584,
165:     456373,
166:     626275,
167:     434896,
168:     606991,
169:     391107,
170:     570591,
171:     329211,
172:     511619,
173:     272295,
174:     440401,
175:     245648,
176:     391103,
177:     229591,
178:     373011,
179:     231684,
180:     379405,
181:     270407,
182:     403513,
183:     290224,
184:     414144,
185:     322897,
186:     434405,
187:     357524,
188:     452032,
189:     380275,
190:     434679,
191:     350343,
192:     378984,
193:     295959,
194:     303586,
195:     229395,
196:     223255,
197:     178886,
198:     166219,
199:     146637,
200:     128426,
201:     109651,
202:      84030,
203:      65294,
204:      45075,
205:      34483,
206:      21619,
207:      16591,
208:       9665,
209:       7499,
210:       5036,
211:       3475,
212:       2361,
213:       1736,
214:       1313,
215:        925,
216:        798,
217:        670,
218:        673,
219:        597,
220:        670,
221:        523,
222:        577,
223:        415,
224:        401,
225:        274,
226:        235,
227:        217,
228:        197,
229:        282,
230:        228,
231:        227,
232:        196,
233:        147,
234:        140,
235:        108,
236:        102,
237:         98,
238:        103,
239:        110,
240:         95,
241:         82,
242:         82,
243:         89,
244:         82,
245:         64,
246:         58,
247:         39,
248:         36,
249:         24,
250:         15,
251:         23,
252:         20,
253:         18,
254:          6,
255:          7,
256:          0,
511: 10558351612,
}

freqs[0] = freqs[0] + freqs[511]
print(freqs[511] / sum(f for _, f in freqs.items()))
del freqs[511]

codec = HuffmanCodec.from_frequencies(freqs)

# codec.print_code_table()


t = codec.get_code_table()
del t[codec._eof]
# del t[511]
s = sum(bits * freqs[symbol] for symbol, (bits, val) in t.items())
s2 = 16 * sum(f for _, f in freqs.items())
# wdls = sum(f for _, f in freqs.items())
print("compressed size:", s / 10**9 / 8)
print("uncompressed size:", s2 / 10**9 / 8)
print("compression ratio:", s / s2)
# print("wdl size:", wdls / 10**9 / 8)